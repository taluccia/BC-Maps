---
title: "BC-Maps"
author: "Anna Talucci"
date: "11/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview



# Packages
```{r}
  library(leaflet)
  library(dplyr)
  library(tidyr)
  library(ggplot2)
  library(DT)
  library(sf)
  library(ggmap) # devtools::install_github("dkahle/ggmap")
library(ggrepel)

library(raster)
library(rgdal)
library(rasterVis)
library(RColorBrewer)
library(cowplot)
library(ggspatial)
library(maps)
```


```{r}
ne1 <- 
  raster("../NE1/NE1_HR_LC_SR_W_DR.tif")

ne1
```

xmin: 273544 ymin: 369009.5 xmax: 1870570 ymax: 1735691
```{r}
plot(ne1)
```



```{r}
fire1 <- st_read(
  "../shapefiles/ch_R10070_2014.shp")
```

```{r}
fire2 <- st_read(
  "../shapefiles/en_R10171_2012.shp")
```

```{r}
fire3 <- st_read(
  "../shapefiles/tw_R10252_2013.shp")
```

```{r}
all_fires= st_read("../shapefiles/perimeter_merge.shp")
```

```{r}
str(all_fires)
```

```{r}
bc = st_read("../shapefiles/province_bc_alber.shp")
```

```{r}
lakes = st_read("../shapefiles/Lakes_select_fire.shp")
```

```{r}
parks = st_read("../shapefiles/tweed-entiako_singlepoly.shp")
```

```{r}
city = st_read("../shapefiles/BC_Vancouver_PrinceGeorge.shp")
```

```{r}
str(city)
```

```{r}
labs <- tibble(
  long = c(-123.1207, -122.7497),
  lat = c(49.2827, 53.9171),
  names = c("Vancouver", "Prince George")) 
```

```{r}
linecolors <- c("#714C02", "#01587A", "#024E37")
fillcolors <- c("#9D6C06", "#077DAA", "#026D4E")

ggplot() + 
  geom_sf(data = bc, fill = NA, color = "black") +
  geom_point(data = all_fires, aes(x = lon, y= lat), position=position_jitter(h=0.1, w=0.1),
             shape = 21, alpha = 0.5, size = 10) +
    scale_color_manual(values=linecolors) +
  scale_fill_manual(values=fillcolors) +

  ggtitle("Fire perimeters for study area") + 
  coord_sf()
```

```{r}
ggplot() + 
  geom_sf(data = bc, fill = "gray75", color = "black") +
  geom_point(data = city, aes(x = lon, y= lat), shape = 24, size = 2, color = "red", fill = "red") +
  geom_label_repel(data = city, aes(x = lon, y= lat, label = c("Prince George", "Vancouver")), vjust = "top", hjust = "left", color = "black") +
  geom_point(data = fire1, aes(x = lon, y= lat), shape =21, alpha = 0.5, size = 3, color = "#714C02", fill = "#9D6C06", position=position_jitter(h=50, w=50)) +
  geom_point(data = fire2, aes(x = lon, y= lat), shape =21, alpha = 0.5, size = 3, color = "#024E37", fill = "#026D4E", position=position_jitter(h=-10, w=-10)) +
  geom_point(data = fire3, aes(x = lon, y= lat), shape =21, alpha = 0.5, size = 2, color = "#01587A", fill = "#077DAA") +
  xlab("")+ylab("")+
  coord_sf()
```


```{r}
ggplot() + 
  geom_sf(data = bc, fill = "gray75", color = "black") +
  geom_point(data = fire1, aes(x = lon, y= lat), shape =21, alpha = 0.5, size = 3, color = "#714C02", fill = "#9D6C06", position=position_jitter(h=50, w=50)) +
  geom_point(data = fire2, aes(x = lon, y= lat), shape =21, alpha = 0.5, size = 3, color = "#024E37", fill = "#026D4E", position=position_jitter(h=-10, w=-10)) +
  geom_point(data = fire3, aes(x = lon, y= lat), shape =21, alpha = 0.5, size = 2, color = "#01587A", fill = "#077DAA") +
  xlab("")+ylab("")+
  coord_sf() +
   
  # add a bounding box so that will border the inset
  theme(panel.background = element_rect(colour = "black", 
                                        size = 0.5))


```
```{r}
map_bc = ggplot() + 
  geom_sf(data = bc, fill = "#E8E8E8", color = "black") +
  geom_point(data = fire1, aes(x = lon, y= lat), shape =21, size = 3, color = "#b82b2b", fill = "#b82b2b", position=position_jitter(h=50, w=50)) +
  geom_point(data = fire2, aes(x = lon, y= lat), shape =21, size = 3, color = "#b82b2b", fill = "#b82b2b", position=position_jitter(h=-10, w=-10)) +
  geom_point(data = fire3, aes(x = lon, y= lat), shape =21, size = 2, color = "#b82b2b", fill = "#b82b2b") +
  xlab("")+ylab("")+
  coord_sf() +
   theme_void() +
  # add a bounding box so that will border the inset
  theme(panel.background = element_rect(colour = "black", fill = "white", size = 0.5))


map_bc
```

```{r}
ggplot() + 
  geom_sf(data = bc, fill = "#E8E8E8", color = "black", legend.outside = TRUE) 
```


```{r}
ggplot() + 
  geom_sf(data = bc, fill = "#E8E8E8", color = "black") +
  geom_sf(data = fire1, fill = NA, color = "#b82b2b", size = 1, show.legend = "line") +
  geom_sf(data = fire2, fill = NA, color = "#b06f0c", size = 1) +
  geom_sf(data = fire3, fill = NA, color = "#dd7116", size = 1) +
  xlab("")+ylab("")+
  coord_sf() +
  scale_colour_manual(values = c("#b82b2b", "#b06f0c", "#dd7116"),
                      guide = guide_legend(override.aes = list(linetype = c("blank", "solid")))) +

  # add a bounding box so that will border the inset
  theme(panel.background = element_rect(colour = "black", fill = "white", size = 0.5)) 



```


```{r}
 ggplot() + 
  geom_sf(data = bc, fill = "#E8E8E8", color = "black") +
  geom_point(data = fire1, aes(x = lon, y= lat), shape =21, size = 3, color = "#b82b2b", fill = "#b82b2b", position=position_jitter(h=50, w=50)) +
  geom_point(data = fire2, aes(x = lon, y= lat), shape =21, size = 3, color = "#b82b2b", fill = "#b82b2b", position=position_jitter(h=-10, w=-10)) +
  geom_point(data = fire3, aes(x = lon, y= lat), shape =21, size = 2, color = "#b82b2b", fill = "#b82b2b") +
  xlab("")+ylab("")+
  coord_sf() +
   theme_light() +
  # add a bounding box so that will border the inset
  theme(panel.background = element_rect(colour = "black", 
                                        size = 0.5))

```
 xmin: 985362 ymin: 894097.7 xmax: 1069051 ymax: 939814.2
  xmin: 999314.8 ymin: 894097.7 xmax: 1069051 ymax: 939814.2
```{r}
ggplot() +
  geom_sf(data = bc, fill = "#cfcfc4", color = "#cfcfc4") +
    geom_sf(data = parks, fill = "#56887d", color = "#56887d") +
    geom_sf(data = lakes, fill = "#56a0d3", color = "#56a0d3") +
  geom_sf(data = fire1, fill = NA, color = "brown") +
  geom_sf(data = fire2, fill = NA, color = "yellow") +
  geom_sf(data = fire3, fill = NA, color = "black") +
  coord_sf(crs = "+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs", xlim = c(985362, 1069051), ylim = c(894097.7, 939814.2), expand = FALSE) 
```

```{r}
ggplot() +
  annotation_map_tile(type = "osm") +
  geom_sf(data = fire1, fill = NA, color = "#F6CF65", size = 2) +
  geom_sf(data = fire2, fill = NA, color = "#D5D8DB", size = 2) +
  geom_sf(data = fire3, fill = NA, color = "#FFF2AF", size = 2) +
  coord_sf(crs = "+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs", xlim = c(985362, 1069051), ylim = c(894097.7, 939814.2), expand = FALSE) 
```

```{r}
ggplot() +
  geom_sf(data = bc, fill = "#E8E8E8", color = "#E8E8E8") +
    geom_sf(data = parks, fill = "#C3ECB2", color = "#C3ECB2") +
    geom_sf(data = lakes, fill = "#AADAFF", color = "#AADAFF") +
  geom_sf(data = fire1, fill = NA, color = "#F6CF65", size = 2) +
  geom_sf(data = fire2, fill = NA, color = "#D5D8DB", size = 2) +
  geom_sf(data = fire3, fill = NA, color = "#FFF2AF", size = 2) +
  scale_color_identity(name = "Map",
                          breaks = c("#E8E8E8", "#C3ECB2", "#AADAFF", "#F6CF65", "#D5D8DB", "#FFF2AF"),
                          labels = c("BC", "Parks", "lakes", "Fire1", "Fire2", "Fire3"),
                          guide = "legend") +
  coord_sf(crs = "+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs", xlim = c(985362, 1069051), ylim = c(894097.7, 939814.2), expand = FALSE) 
```
xlim = c(985362, 1069051), ylim = c(894097.7, 939814.2),
```{r}
map_fires = ggplot() +
  geom_sf(data = bc, fill = "#E8E8E8", color = "#E8E8E8") +
    geom_sf(data = parks, fill = "#C3ECB2", color = "#C3ECB2") +
    geom_sf(data = lakes, fill = "#AADAFF", color = "#AADAFF") +
  geom_sf(data = fire1, fill = NA, color = "#b82b2b", size = 1) +
  geom_sf(data = fire2, fill = NA, color = "#b06f0c", size = 1) +
  geom_sf(data = fire3, fill = NA, color = "#dd7116", size = 1) +
  coord_sf(crs = "+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000 +y_0=0 +datum=NAD83 +units=m +no_defs", xlim = c(983000, 1071000), ylim = c(892000, 941000), expand = FALSE)  + 
      annotation_scale(location = "br", width_hint = 0.25, text_size = 12, text_face = NULL, text_family = "serif", text_col = "black") +
    annotation_north_arrow(location = "br", which_north = "true", 
        pad_x = unit(0.75, "in"), pad_y = unit(0.5, "in"),
        style = north_arrow_nautical(line_width = 1, line_col = "black", fill = c("black", "white"), text_size = 10, text_face = NULL, text_family = "serif", text_col = "black", text_angle = 0)) +
  theme(axis.text.x = element_text(face = "plain", color = "black", size = 12),
        axis.text.y = element_text(face = "plain", color = "black", size = 12)) 


map_fires
```

```{r}
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft", legend =c('Provincial parks', 'Lakes', ' Chelaslie (2014)', 'Tweedsmuir (2013)',
    'Entiako (2012)'), pch=16, pt.cex=3, cex=1.5, bty='n',
    col = c("#C3ECB2", "#AADAFF", "#b82b2b", "#b06f0c", "#dd7116"))
mtext("", at=0.2, cex=2)
```


cfgrid21 = plot_grid(cfgrid20, legend, ncol=1, rel_widths = c(1, .1), rel_heights = c(1, .05)) 

```{r fig.height=9, fig.width=15}

map_bc_legend = ggdraw() +
   draw_plot(map_fires) +
  draw_plot(map_bc, x = 0.05, y = 0.1, width = .25, height = .25) +
  draw_label("Chelaslie\n(2014)", x = .4, y = .8, fontface = "plain", color = "black", size = 12) +
  draw_label("Chelaslie\n(2014)", x = .5, y = .6, fontface = "plain", color = "black", size = 12) +
  draw_label("Entiako\n(2012)", x = .56, y = .4, fontface = "plain", color = "black", size = 12) +
  draw_label("Tweedsmuir\n(2013)", x = .14, y = .57, fontface = "plain", color = "black", size = 12, angle = 30) 

map_bc_legend


```


```{r fig.height=9, fig.width=15}

map_bc_labels = ggdraw() +
   draw_plot(map_fires) +
  draw_plot(map_bc, x = 0.05, y = 0.1, width = .25, height = .25) +
  draw_label("Chelaslie\n(2014)", x = .4, y = .8, fontface = "plain", color = "black", size = 12) +
  draw_label("Chelaslie\n(2014)", x = .5, y = .6, fontface = "plain", color = "black", size = 12) +
  draw_label("Entiako\n(2012)", x = .56, y = .4, fontface = "plain", color = "black", size = 12) +
  draw_label("Tweedsmuir\n(2013)", x = .14, y = .57, fontface = "plain", color = "black", size = 12, angle = 30) 

map_bc_labels


```
```{r}
ggsave("../figures/bc_map_labels.png", plot = map_bc_labels, width = 15, height = 9, dpi = 600)
```

```{r fig.height=8, fig.width=14}
map_inset = 
  ggdraw() +
   draw_plot(map_fires) +
  draw_plot(map_bc, x = 0.05, y = 0.1, width = .25, height = .25)

map_inset

```

```{r}
ggsave("../figures/bc_map.png", width = 14, height = 8, dpi = 600)
```

```{r}
ggplot() +
  geom_sf(data = fire1, fill = NA, color = "brown") +
  geom_sf(data = fire2, fill = NA, color = "yellow") +
  geom_sf(data = fire3, fill = NA, color = "black") +
  ggtitle("Fire perimeters for study area") + 
  coord_sf()
```


```{r}
ggplot() + 
  geom_sf(data = bc, fill = NA, color = "black") +
  geom_sf(data = city, color = "red", size = 2) +
  geom_sf(data = fire1, fill = NA, color = "brown") +
  geom_sf(data = fire2, fill = NA, color = "yellow") +
  geom_sf(data = fire3, fill = NA, color = "black") +
  ggtitle("Fire perimeters for study area") + 
  coord_sf()
```


```{r}
ggplot() + 
  geom_sf(data = bc, fill = NA, color = "black") +
  geom_sf(data = city, color = "red", size = 4) +
  coord_sf()
```






